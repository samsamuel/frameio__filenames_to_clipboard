javascript:(()=>{const KEY='fio_walk_v1';const EXT=/\.(mp4|mov|m4v|wav|mp3|aif|aiff|mxf|flac|avi|mkv|webm|pdf|jpg|jpeg|png|tif|tiff|gif|webp|heic|psd|ai|indd|zip|rar|7z|tar|gz|bz2|docx?|xlsx?|pptx?|csv)$/i;const clean=s=>s.replace(/\s+/g,' ').replace(/^[^\w\[\]().-]+|[^\w\[\]().-\s]+$/g,'').trim();const looks=s=>!!s&&EXT.test(s.trim());const fromHref=h=>{try{const u=new URL(h,location.href);return decodeURIComponent((u.pathname.split('/').pop()||'').split('?')[0]);}catch{return''}};const addFiles=(set,raw)=>{if(!raw)return;const t=clean(raw);if(t&&looks(t)) set.add(t);};const crawlNames=()=>{const S=new Set();const visit=n=>{if(!n)return;if(n.nodeType===Node.TEXT_NODE){addFiles(S,n.textContent);} else if(n.nodeType===Node.ELEMENT_NODE){const el=n;['data-filename','data-name','title','aria-label','download'].forEach(a=>{const v=el.getAttribute&&el.getAttribute(a);if(v) addFiles(S,v);});if(el.tagName==='A'){const href=el.getAttribute('href');if(href){const f=fromHref(href);if(f) addFiles(S,f);}}el.childNodes&&el.childNodes.forEach(visit);if(el.shadowRoot){el.shadowRoot.childNodes.forEach(visit);}}};visit(document.documentElement);document.querySelectorAll('script[type="application/json"],script').forEach(sc=>{const t=sc.textContent||'';if(!t)return;let m;const reName=/"(?:name|display_name)"\s*:\s*"([^"]{1,240})"/g;while((m=reName.exec(t))) addFiles(S,m[1]);const reHref=/"href"\s*:\s*"([^"]+)"/g;while((m=reHref.exec(t))) {const f=fromHref(m[1]);if(f) addFiles(S,f);} });return [...S];};const findFolderLinks=()=>{const L=new Set();const pushEl=el=>{if(!el)return;const href=el.getAttribute&&el.getAttribute('href');if(href&&/\/reviews\//.test(href)) L.add(new URL(href,location.href).toString());};document.querySelectorAll('a,[role="link"]').forEach(a=>{const txt=(a.getAttribute('aria-label')||a.textContent||'').toLowerCase();const type=(a.getAttribute('data-asset-type')||'').toLowerCase();const testid=(a.getAttribute('data-testid')||'').toLowerCase();const cls=(a.className||'').toString().toLowerCase();const looksFolder=type.includes('folder')||testid.includes('folder')||cls.includes('folder')||/\bfolder\b/.test(txt);if(looksFolder){const link=a.closest('a')||a;pushEl(link);}});return [...L];};const load=()=>{try{return JSON.parse(localStorage.getItem(KEY)||'null')||null;}catch{return null}};const save=s=>localStorage.setItem(KEY,JSON.stringify(s));const init=()=>{const here=new URL(location.href);const root=here.origin+here.pathname;return {root,queue:[root],seen:new Set(),files:new Set(),done:new Set()}};let st=load();if(!st){st=init();}const toSet=o=>{o.seen=new Set(o.seen||[]);o.files=new Set(o.files||[]);o.done=new Set(o.done||[]);return o};st=toSet(st);const here=location.href.split('#')[0];if(!st.seen.has(here)) st.queue.unshift(here);const addAll=(set,arr)=>arr.forEach(v=>set.add(v));const filesHere=crawlNames();addAll(st.files,filesHere);st.done.add(here);st.seen.add(here);st.queue=st.queue.filter(u=>u!==here);const folders=findFolderLinks().filter(u=>!st.seen.has(u));folders.forEach(u=>{if(!st.queue.includes(u)) st.queue.push(u)});const arrFiles=[...st.files].sort((a,b)=>a.localeCompare(b,undefined,{numeric:true,sensitivity:'base'}));if(st.queue.length===0){save({root:st.root,queue:[],seen:[...st.seen],files:[...st.files],done:[...st.done]});const out=arrFiles.join('\n');(async()=>{try{await navigator.clipboard.writeText(out);alert(`Done! Copied ${arrFiles.length} filenames (newline-separated).`);}catch{const w=open('','_blank','width=700,height=500');if(w){w.document.write('<pre style="white-space:pre;font:14px system-ui">'+out.replace(/[&<>]/g,m=>({"&":"&amp;","<":"&lt;",">":"&gt;"}[m]))+'</pre>');}}})();localStorage.removeItem(KEY);return;}save({root:st.root,queue:st.queue,seen:[...st.seen],files:[...st.files],done:[...st.done]});const next=st.queue[0];if(next){location.assign(next);}else{alert('No more folders found, but queue is empty. Run again or clear state.');localStorage.removeItem(KEY);}})();
